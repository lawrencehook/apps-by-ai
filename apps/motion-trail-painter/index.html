<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Motion Trail Painter - AI Showcase</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: system-ui, -apple-system, sans-serif;
            background: #0a0a0f;
            min-height: 100vh;
            color: #e0e0e0;
            overflow: hidden;
        }
        .back-link {
            position: fixed; top: 20px; right: 20px; color: #666; text-decoration: none;
            font-size: 14px; padding: 8px 14px; background: rgba(0,0,0,0.85);
            border-radius: 6px; border: 1px solid rgba(255,255,255,0.1); z-index: 100;
        }
        .back-link:hover { color: #fff; }
        #canvas {
            width: 100vw;
            height: 100vh;
            display: block;
            cursor: crosshair;
        }
        .controls {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            gap: 12px;
            padding: 16px 20px;
            background: rgba(0,0,0,0.85);
            border-radius: 12px;
            border: 1px solid rgba(255,255,255,0.1);
            z-index: 100;
            flex-wrap: wrap;
            justify-content: center;
            max-width: 90vw;
        }
        .control-group {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .control-label {
            font-size: 0.75rem;
            color: #888;
            white-space: nowrap;
        }
        input[type="range"] {
            width: 80px;
            height: 4px;
            -webkit-appearance: none;
            background: rgba(255,255,255,0.2);
            border-radius: 2px;
        }
        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 14px;
            height: 14px;
            background: #fff;
            border-radius: 50%;
            cursor: pointer;
        }
        input[type="color"] {
            width: 32px;
            height: 32px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            background: transparent;
        }
        input[type="color"]::-webkit-color-swatch-wrapper { padding: 0; }
        input[type="color"]::-webkit-color-swatch {
            border-radius: 6px;
            border: 2px solid rgba(255,255,255,0.3);
        }
        .btn {
            padding: 8px 16px;
            border: 1px solid rgba(255,255,255,0.15);
            border-radius: 6px;
            background: rgba(255,255,255,0.05);
            color: #fff;
            font-size: 0.8rem;
            cursor: pointer;
            transition: all 0.2s;
        }
        .btn:hover { background: rgba(255,255,255,0.1); }
        .btn-primary {
            background: rgba(78, 205, 196, 0.2);
            border-color: rgba(78, 205, 196, 0.4);
            color: #4ecdc4;
        }
        .btn-primary:hover { background: rgba(78, 205, 196, 0.3); }
        select {
            padding: 6px 10px;
            border: 1px solid rgba(255,255,255,0.15);
            border-radius: 6px;
            background: rgba(255,255,255,0.05);
            color: #fff;
            font-size: 0.8rem;
            cursor: pointer;
        }
        .info-panel {
            position: fixed;
            top: 20px;
            left: 20px;
            padding: 16px 20px;
            background: rgba(0,0,0,0.85);
            border-radius: 12px;
            border: 1px solid rgba(255,255,255,0.1);
            z-index: 100;
        }
        .info-panel h1 {
            font-size: 1.2rem;
            margin-bottom: 4px;
            color: #fff;
        }
        .info-panel p {
            font-size: 0.75rem;
            color: #666;
        }
        .checkbox-group {
            display: flex;
            align-items: center;
            gap: 6px;
        }
        .checkbox-group input[type="checkbox"] {
            width: 16px;
            height: 16px;
            cursor: pointer;
        }
        @media (max-width: 768px) {
            .controls {
                bottom: 10px;
                padding: 12px;
                gap: 8px;
            }
            .info-panel {
                top: 10px;
                left: 10px;
                right: 10px;
                padding: 12px;
            }
            .info-panel h1 { font-size: 1rem; }
        }
    </style>
</head>
<body>
    <a href="../../index.html" class="back-link">‚Üê Back</a>

    <div class="info-panel">
        <h1>Motion Trail Painter</h1>
        <p>Draw with your mouse or touch to create glowing trails.</p>
    </div>

    <canvas id="canvas"></canvas>

    <div class="controls">
        <div class="control-group">
            <span class="control-label">Color</span>
            <input type="color" id="colorPicker" value="#4ecdc4">
        </div>
        <div class="control-group">
            <span class="control-label">Size</span>
            <input type="range" id="sizeSlider" min="2" max="50" value="15">
        </div>
        <div class="control-group">
            <span class="control-label">Glow</span>
            <input type="range" id="glowSlider" min="0" max="50" value="20">
        </div>
        <div class="control-group">
            <span class="control-label">Decay</span>
            <input type="range" id="decaySlider" min="1" max="20" value="5">
        </div>
        <div class="control-group">
            <span class="control-label">Mode</span>
            <select id="modeSelect">
                <option value="normal">Normal</option>
                <option value="rainbow">Rainbow</option>
                <option value="pulse">Pulse</option>
                <option value="spark">Spark</option>
            </select>
        </div>
        <div class="control-group checkbox-group">
            <input type="checkbox" id="mirrorCheck">
            <span class="control-label">Mirror</span>
        </div>
        <button class="btn" id="clearBtn">Clear</button>
        <button class="btn btn-primary" id="saveBtn">Save PNG</button>
    </div>

    <script>
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');

        let trails = [];
        let isDrawing = false;
        let lastX = 0, lastY = 0;
        let hue = 0;
        let time = 0;

        // Settings
        let brushColor = '#4ecdc4';
        let brushSize = 15;
        let glowIntensity = 20;
        let decaySpeed = 5;
        let mode = 'normal';
        let mirror = false;

        function resizeCanvas() {
            // Preserve existing content during resize
            const tempCanvas = document.createElement('canvas');
            tempCanvas.width = canvas.width;
            tempCanvas.height = canvas.height;
            const tempCtx = tempCanvas.getContext('2d');
            tempCtx.drawImage(canvas, 0, 0);

            canvas.width = window.innerWidth * window.devicePixelRatio;
            canvas.height = window.innerHeight * window.devicePixelRatio;
            ctx.setTransform(1, 0, 0, 1, 0, 0);
            ctx.scale(window.devicePixelRatio, window.devicePixelRatio);

            // Restore previous content
            ctx.drawImage(tempCanvas, 0, 0, tempCanvas.width, tempCanvas.height,
                          0, 0, window.innerWidth, window.innerHeight);
        }

        function hexToRgb(hex) {
            const result = /^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(hex);
            return result ? {
                r: parseInt(result[1], 16),
                g: parseInt(result[2], 16),
                b: parseInt(result[3], 16)
            } : { r: 78, g: 205, b: 196 };
        }

        function hslToRgb(h, s, l) {
            h /= 360; s /= 100; l /= 100;
            let r, g, b;
            if (s === 0) {
                r = g = b = l;
            } else {
                const hue2rgb = (p, q, t) => {
                    if (t < 0) t += 1;
                    if (t > 1) t -= 1;
                    if (t < 1/6) return p + (q - p) * 6 * t;
                    if (t < 1/2) return q;
                    if (t < 2/3) return p + (q - p) * (2/3 - t) * 6;
                    return p;
                };
                const q = l < 0.5 ? l * (1 + s) : l + s - l * s;
                const p = 2 * l - q;
                r = hue2rgb(p, q, h + 1/3);
                g = hue2rgb(p, q, h);
                b = hue2rgb(p, q, h - 1/3);
            }
            return { r: Math.round(r * 255), g: Math.round(g * 255), b: Math.round(b * 255) };
        }

        function addTrailPoint(x, y) {
            let color;
            let size = brushSize;

            switch (mode) {
                case 'rainbow':
                    color = hslToRgb(hue, 80, 60);
                    hue = (hue + 2) % 360;
                    break;
                case 'pulse':
                    const pulse = Math.sin(time * 0.1) * 0.5 + 0.5;
                    const baseColor = hexToRgb(brushColor);
                    color = {
                        r: Math.round(baseColor.r * (0.5 + pulse * 0.5)),
                        g: Math.round(baseColor.g * (0.5 + pulse * 0.5)),
                        b: Math.round(baseColor.b * (0.5 + pulse * 0.5))
                    };
                    size = brushSize * (0.7 + pulse * 0.6);
                    break;
                case 'spark':
                    color = hexToRgb(brushColor);
                    // Add random sparks
                    if (Math.random() < 0.3) {
                        for (let i = 0; i < 3; i++) {
                            const angle = Math.random() * Math.PI * 2;
                            const dist = Math.random() * 30 + 10;
                            trails.push({
                                x: x + Math.cos(angle) * dist,
                                y: y + Math.sin(angle) * dist,
                                size: Math.random() * 4 + 1,
                                alpha: 1,
                                color: { r: 255, g: 255, b: 200 }
                            });
                        }
                    }
                    break;
                default:
                    color = hexToRgb(brushColor);
            }

            trails.push({
                x: x,
                y: y,
                size: size,
                alpha: 1,
                color: color
            });

            if (mirror) {
                trails.push({
                    x: window.innerWidth - x,
                    y: y,
                    size: size,
                    alpha: 1,
                    color: color
                });
            }

            // Limit trails to prevent performance issues
            const MAX_TRAILS = 5000;
            if (trails.length > MAX_TRAILS) {
                trails.splice(0, trails.length - MAX_TRAILS);
            }
        }

        function draw() {
            // Semi-transparent overlay for trail fade effect
            ctx.fillStyle = `rgba(10, 10, 15, ${decaySpeed / 100})`;
            ctx.fillRect(0, 0, window.innerWidth, window.innerHeight);

            // Update and draw trails
            for (let i = trails.length - 1; i >= 0; i--) {
                const trail = trails[i];

                // Draw glow
                if (glowIntensity > 0) {
                    const gradient = ctx.createRadialGradient(
                        trail.x, trail.y, 0,
                        trail.x, trail.y, trail.size * 2 + glowIntensity
                    );
                    gradient.addColorStop(0, `rgba(${trail.color.r}, ${trail.color.g}, ${trail.color.b}, ${trail.alpha * 0.5})`);
                    gradient.addColorStop(1, 'transparent');
                    ctx.fillStyle = gradient;
                    ctx.beginPath();
                    ctx.arc(trail.x, trail.y, trail.size * 2 + glowIntensity, 0, Math.PI * 2);
                    ctx.fill();
                }

                // Draw core
                ctx.beginPath();
                ctx.arc(trail.x, trail.y, trail.size * trail.alpha, 0, Math.PI * 2);
                ctx.fillStyle = `rgba(${trail.color.r}, ${trail.color.g}, ${trail.color.b}, ${trail.alpha})`;
                ctx.fill();

                // Decay
                trail.alpha -= 0.01 * decaySpeed;

                if (trail.alpha <= 0) {
                    trails.splice(i, 1);
                }
            }

            time++;
            requestAnimationFrame(draw);
        }

        function getEventPos(e) {
            if (e.touches) {
                return { x: e.touches[0].clientX, y: e.touches[0].clientY };
            }
            return { x: e.clientX, y: e.clientY };
        }

        function startDrawing(e) {
            isDrawing = true;
            const pos = getEventPos(e);
            lastX = pos.x;
            lastY = pos.y;
            addTrailPoint(pos.x, pos.y);
        }

        function stopDrawing() {
            isDrawing = false;
        }

        function drawMove(e) {
            if (!isDrawing) return;
            e.preventDefault();

            const pos = getEventPos(e);

            // Interpolate between last position and current for smooth trails
            const dx = pos.x - lastX;
            const dy = pos.y - lastY;
            const dist = Math.sqrt(dx * dx + dy * dy);
            const steps = Math.max(1, Math.floor(dist / 3));

            for (let i = 0; i <= steps; i++) {
                const t = i / steps;
                const x = lastX + dx * t;
                const y = lastY + dy * t;
                addTrailPoint(x, y);
            }

            lastX = pos.x;
            lastY = pos.y;
        }

        // Event listeners
        canvas.addEventListener('mousedown', startDrawing);
        canvas.addEventListener('mousemove', drawMove);
        canvas.addEventListener('mouseup', stopDrawing);
        canvas.addEventListener('mouseleave', stopDrawing);

        canvas.addEventListener('touchstart', (e) => {
            e.preventDefault();
            startDrawing(e);
        });
        canvas.addEventListener('touchmove', (e) => {
            e.preventDefault();
            drawMove(e);
        });
        canvas.addEventListener('touchend', stopDrawing);

        // Controls
        document.getElementById('colorPicker').addEventListener('input', (e) => {
            brushColor = e.target.value;
        });

        document.getElementById('sizeSlider').addEventListener('input', (e) => {
            brushSize = parseInt(e.target.value);
        });

        document.getElementById('glowSlider').addEventListener('input', (e) => {
            glowIntensity = parseInt(e.target.value);
        });

        document.getElementById('decaySlider').addEventListener('input', (e) => {
            decaySpeed = parseInt(e.target.value);
        });

        document.getElementById('modeSelect').addEventListener('change', (e) => {
            mode = e.target.value;
        });

        document.getElementById('mirrorCheck').addEventListener('change', (e) => {
            mirror = e.target.checked;
        });

        document.getElementById('clearBtn').addEventListener('click', () => {
            trails = [];
            ctx.fillStyle = '#0a0a0f';
            ctx.fillRect(0, 0, window.innerWidth, window.innerHeight);
        });

        document.getElementById('saveBtn').addEventListener('click', () => {
            // Create a clean snapshot
            const saveCanvas = document.createElement('canvas');
            saveCanvas.width = canvas.width;
            saveCanvas.height = canvas.height;
            const saveCtx = saveCanvas.getContext('2d');

            // Draw current canvas
            saveCtx.drawImage(canvas, 0, 0);

            const link = document.createElement('a');
            link.download = 'motion-trail.png';
            link.href = saveCanvas.toDataURL('image/png');
            link.click();
        });

        // Initialize
        window.addEventListener('resize', resizeCanvas);
        resizeCanvas();

        // Fill with dark background
        ctx.fillStyle = '#0a0a0f';
        ctx.fillRect(0, 0, window.innerWidth, window.innerHeight);

        // Start animation loop
        draw();
    </script>
</body>
</html>
