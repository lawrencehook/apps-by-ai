<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Julia Sets - Apps by AI</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        html, body {
            font-family: system-ui, -apple-system, sans-serif;
            background: #0a0a0f;
            height: 100vh;
            overflow: hidden;
            color: #e0e0e0;
        }
        .container {
            height: 100vh;
            display: flex;
            flex-direction: column;
            padding: 12px;
        }
        .header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 10px;
        }
        .title-section {
            display: flex;
            align-items: baseline;
            gap: 12px;
        }
        h1 { font-size: 1.3rem; color: #fff; }
        .subtitle { color: #666; font-size: 0.8rem; }
        .back-link {
            color: #666; text-decoration: none; font-size: 13px;
            padding: 6px 12px; background: rgba(255,255,255,0.05);
            border-radius: 6px; border: 1px solid rgba(255,255,255,0.1);
        }
        .back-link:hover { color: #fff; }
        .controls {
            display: flex;
            gap: 16px;
            align-items: center;
            padding: 10px 14px;
            background: rgba(255,255,255,0.03);
            border: 1px solid rgba(255,255,255,0.08);
            border-radius: 8px;
            margin-bottom: 10px;
            flex-wrap: wrap;
        }
        .control-group {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        label { color: #888; font-size: 0.75rem; }
        input[type="range"] { width: 100px; accent-color: #4ecdc4; }
        .value { color: #4ecdc4; font-family: monospace; font-size: 0.8rem; min-width: 50px; }
        select {
            background: rgba(255,255,255,0.05);
            border: 1px solid rgba(255,255,255,0.15);
            color: #fff; padding: 4px 8px; border-radius: 4px; font-size: 0.8rem;
        }
        .canvas-container {
            flex: 1;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 0;
            position: relative;
        }
        canvas {
            max-width: 100%;
            max-height: 100%;
            border-radius: 8px;
            cursor: crosshair;
        }
        .info {
            position: absolute;
            bottom: 10px;
            left: 10px;
            background: rgba(0,0,0,0.8);
            padding: 8px 12px;
            border-radius: 6px;
            font-size: 0.75rem;
            color: #888;
        }
        .info span { color: #4ecdc4; font-family: monospace; }
        .presets {
            display: flex;
            gap: 6px;
        }
        .preset {
            background: rgba(255,255,255,0.05);
            border: 1px solid rgba(255,255,255,0.15);
            color: #888; padding: 4px 10px; border-radius: 4px;
            cursor: pointer; font-size: 0.75rem;
        }
        .preset:hover { background: rgba(255,255,255,0.1); color: #fff; }
        .loading {
            position: absolute;
            color: #4ecdc4;
            font-size: 0.9rem;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="title-section">
                <h1>Julia Sets</h1>
                <span class="subtitle">Each point in the Mandelbrot set defines a unique Julia set</span>
            </div>
            <a href="../../index.html" class="back-link">‚Üê Back</a>
        </div>

        <div class="controls">
            <div class="control-group">
                <label>Real (c)</label>
                <input type="range" id="realC" min="-2" max="2" step="0.001" value="-0.7">
                <span class="value" id="realVal">-0.70</span>
            </div>
            <div class="control-group">
                <label>Imag (c)</label>
                <input type="range" id="imagC" min="-2" max="2" step="0.001" value="0.27">
                <span class="value" id="imagVal">0.27</span>
            </div>
            <div class="control-group">
                <label>Iterations</label>
                <input type="range" id="maxIter" min="50" max="500" step="10" value="200">
                <span class="value" id="iterVal">200</span>
            </div>
            <div class="control-group">
                <label>Color</label>
                <select id="colorScheme">
                    <option value="classic">Classic</option>
                    <option value="fire">Fire</option>
                    <option value="ocean">Ocean</option>
                    <option value="rainbow">Rainbow</option>
                    <option value="grayscale">Grayscale</option>
                </select>
            </div>
            <div class="presets">
                <button class="preset" data-c="-0.7,0.27015">Dendrite</button>
                <button class="preset" data-c="-0.8,0.156">Spiral</button>
                <button class="preset" data-c="0.285,0.01">Galaxy</button>
                <button class="preset" data-c="-0.4,0.6">Rabbit</button>
                <button class="preset" data-c="0.355,0.355">Feather</button>
            </div>
        </div>

        <div class="canvas-container">
            <canvas id="canvas"></canvas>
            <div class="info">c = <span id="cValue">-0.70 + 0.27i</span> | Click Mandelbrot point to explore</div>
            <div class="loading" id="loading" style="display: none;">Rendering...</div>
        </div>
    </div>

    <script>
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');
        const realSlider = document.getElementById('realC');
        const imagSlider = document.getElementById('imagC');
        const iterSlider = document.getElementById('maxIter');
        const colorSelect = document.getElementById('colorScheme');

        let width, height;

        function resize() {
            const container = document.querySelector('.canvas-container');
            const size = Math.max(100, Math.min(container.clientWidth, container.clientHeight) - 20);
            width = height = Math.floor(size);
            canvas.width = width;
            canvas.height = height;
            render();
        }

        const colorSchemes = {
            classic: (t) => {
                const r = Math.floor(9 * (1 - t) * t * t * t * 255);
                const g = Math.floor(15 * (1 - t) * (1 - t) * t * t * 255);
                const b = Math.floor(8.5 * (1 - t) * (1 - t) * (1 - t) * t * 255);
                return [r, g, b];
            },
            fire: (t) => [
                Math.floor(Math.min(255, t * 3 * 255)),
                Math.floor(Math.max(0, (t - 0.33) * 3 * 255)),
                Math.floor(Math.max(0, (t - 0.66) * 3 * 255))
            ],
            ocean: (t) => [
                Math.floor(t * 100),
                Math.floor(t * 180 + 75 * (1 - t)),
                Math.floor(200 + t * 55)
            ],
            rainbow: (t) => {
                const h = t * 360;
                const s = 0.8, v = 1;
                const c = v * s, x = c * (1 - Math.abs((h / 60) % 2 - 1)), m = v - c;
                let r, g, b;
                if (h < 60) [r, g, b] = [c, x, 0];
                else if (h < 120) [r, g, b] = [x, c, 0];
                else if (h < 180) [r, g, b] = [0, c, x];
                else if (h < 240) [r, g, b] = [0, x, c];
                else if (h < 300) [r, g, b] = [x, 0, c];
                else [r, g, b] = [c, 0, x];
                return [Math.floor((r + m) * 255), Math.floor((g + m) * 255), Math.floor((b + m) * 255)];
            },
            grayscale: (t) => {
                const v = Math.floor(t * 255);
                return [v, v, v];
            }
        };

        function render() {
            const cReal = parseFloat(realSlider.value);
            const cImag = parseFloat(imagSlider.value);
            const maxIter = parseInt(iterSlider.value);
            const colorFn = colorSchemes[colorSelect.value];

            document.getElementById('realVal').textContent = cReal.toFixed(3);
            document.getElementById('imagVal').textContent = cImag.toFixed(3);
            document.getElementById('iterVal').textContent = maxIter;
            document.getElementById('cValue').textContent = `${cReal.toFixed(3)} ${cImag >= 0 ? '+' : '-'} ${Math.abs(cImag).toFixed(3)}i`;

            const imageData = ctx.createImageData(width, height);
            const data = imageData.data;

            const zoom = 3;
            const offsetX = -zoom / 2;
            const offsetY = -zoom / 2;

            for (let py = 0; py < height; py++) {
                for (let px = 0; px < width; px++) {
                    let zx = px / width * zoom + offsetX;
                    let zy = py / height * zoom + offsetY;

                    let iter = 0;
                    while (zx * zx + zy * zy < 4 && iter < maxIter) {
                        const tmp = zx * zx - zy * zy + cReal;
                        zy = 2 * zx * zy + cImag;
                        zx = tmp;
                        iter++;
                    }

                    const idx = (py * width + px) * 4;
                    if (iter === maxIter) {
                        data[idx] = data[idx + 1] = data[idx + 2] = 0;
                    } else {
                        const t = iter / maxIter;
                        const [r, g, b] = colorFn(t);
                        data[idx] = r;
                        data[idx + 1] = g;
                        data[idx + 2] = b;
                    }
                    data[idx + 3] = 255;
                }
            }

            ctx.putImageData(imageData, 0, 0);
        }

        let renderTimeout;
        function debouncedRender() {
            clearTimeout(renderTimeout);
            document.getElementById('loading').style.display = '';
            renderTimeout = setTimeout(() => {
                render();
                document.getElementById('loading').style.display = 'none';
            }, 50);
        }

        realSlider.addEventListener('input', debouncedRender);
        imagSlider.addEventListener('input', debouncedRender);
        iterSlider.addEventListener('input', debouncedRender);
        colorSelect.addEventListener('change', render);

        document.querySelectorAll('.preset').forEach(btn => {
            btn.addEventListener('click', () => {
                const [r, i] = btn.dataset.c.split(',').map(Number);
                realSlider.value = r;
                imagSlider.value = i;
                render();
            });
        });

        window.addEventListener('resize', resize);
        resize();
    </script>
</body>
</html>
